## Supplementary Figures {.page_break_before}

### Sequence Modeling

DDMC simultaneously models phosphorylation signal and peptide sequence to cluster global signaling measurements. The user-defined variables of this algorithm are the number of clusters and the scaling factor or weight to prioritize the data or the sequence scores. During the Expectation– or E-step, the algorithm guesses a data and a sequence probability distribution given the current model parameters to assign every peptide into a cluster based on its maximum likelihood estimation. That is, the GMM generates the probabilities of each phosphosite being assigned to every cluster according to its log-transformed abundance. In the PAM250 method, the average distance between a peptide’s sequence and each of those within a cluster are calculated using the transition matrix. For the binomial method, we collected 333,492 random MS-generated phosphopeptides from the public compendium PhosphoSitePlus13 to be used as the set of background sequences. The probability of observing each amino acid at each position was calculated by comparing each cluster and the background using an incomplete beta function. First, the cluster sequences are used to build counts matrices displaying the number of amino acid occurrences across positions. These matrices are then individually compared to the weighted frequencies matrix of the background set of sequences using a binomially distributed model in order to generate a binomial probability matrix for each cluster. The probability of a peptide being assigned to any cluster is the average of each position’s probability present in the correspondinog cluster’s binomial probability matrix. For each cluster, the final score is the sum of the GMM and sequence scores multiplied by a user-defined weight which scales both scores so that a weight of 0 or a very large number only scores the data or sequence, respectively. Importantly, the final scores represent the relative probabilities that define the partial membership of the query peptide to each cluster. In other words, the EM algorithm provides soft cluster assignments for every peptide. Then, the GMM parameters and cluster sequences are updated during the M-step based on the assignments generated during the previous E-step. These two steps repeat until convergence.

![**Schematic of the DDMC simultaneous data and peptide sequence clustering approach.** Peptides are initialized into clusters at random. The measurements of abundance are represented by a multivariate Gaussian mixture model where each dimension of the distribution represents the abundance within a sample. Next, an expectation-maximization fitting scheme is used. During the expectation step, the distance of each peptide sequence to each cluster is calculated. This is done either through a binomial enrichment scheme (method 1) or using the average PAM250 distance (method 2). In parallel, the distance of each peptide abundance is compared to the cluster centers. These two distances are combined to update the assignments of each peptide to each cluster. During the maximization step, the cluster centers of the data are updated based on the weighted average of the peptide abundances in each condition. The peptide motifs are similarly updated through a weighted combination of the assigned peptides. Both steps continue sequentially until the change in peptide assignments between each iteration drops below a threshold.](EM_diagram.svg){#fig:methodS width="100%", tag="S1"}

### Logo plots of all Cluster Motifs {.page_break_before}

![**Logo plots of all Cluster PSSMs.** (A-U) Sequence motifs of clusters 1 through 24.](figureMS2.svg){#fig:motifsS tag="S2"}

### Implementing different modeling strategies to find tumor differences compared to NATs {.page_break_before}

![**Additional modeling strategies to find conserved tumor differences compared to NATs.** A) ROC plot of a lasso model fit to the complete portion of the phosphoproteomic CPTAC LUAD data set. B) Phospho-peptides with largest weights explaining the observed differences between tumors and NATs. C-D) ROC plot of a lasso model fit to the complete portion of the signaling data set clustered by k-means (D) and its corresponding cluester coefficients (D). E) p-site abundance between NAT and tumor patients per k-means cluster and its statistical significance. (F-H) Analysis using GMM clustering.](figureMS3.svg){#fig:TvsNATS tag="S3"}

### Regressing DDMC clusters against the mutational status of EGFR/ALK {.page_break_before}

![**Prediction of patient samples harboring EGFR mutations or ALK fusions (EGFRm/ALKf).** A) Phosphorylation signal of DDMC clusters grouped by EGFRm/ALKf mutantants and WT samples. Its statistical significance is indicated on the top part of the plot via a series of Mann Whitney rank test. B) ROC plot of the lasso model fit to the DDMC clusters. (D-G) Logo plots of the sequence motifs for clusters 2, 13, 20, and 23. H) Prediction of upstream kinases corresponding to the aforementioned clusters.](figureMS4.svg){#fig:EGFRm/ALKf tag="S4"}

### Comparing the predictive of performance of using DDMC to different regression strategies {.page_break_before}

![**Comparing the predictive performance of a lasso model using different modeling strategies.** (A-D) Lasso's predictive performance of STK11 mutational status using DDMC clusters (A), unclustered signaling data (B), k-means clusters (C) and GMM clusters (D). Predictive performance of a lasso model regressed against EGFRm/ALKf mutational status. Note that a complete portion of the entire data set containing 1311 peptides was used for every modeling strategy other than DDMC. DDMC was fit to 30561 peptides that include at least a minimum of 2 10-plex TMT experiments.](figureMS5.svg){#fig:RegressionsS tag="S5"}

### Dual data-motif clustering strategy robustly imputes missing values {.page_break_before}

![**Benchmarking the robustness of motif clustering to missing measurements.** A) A schematic of the process for quantifying robustness to missing values. Any peptides containing less than 7 TMT experiments were discarded. For the remaining 15904 peptides, an entire random TMT experiment was removed per peptide and these values were stored for later comparison. Next, these artifical missing values were imputed using either a baseline strategy (peptide mean/minimum signal) or the corresponding cluster center. Once a mean squared error was computed for each peptide, the second iteration repeats this process by removing a second TMT experiment. A total of 5 random TMT experiments per peptide were imputed by clustering using either the peptides' phosphorylation signal only (B), the peptides' sequence only (C) or a mix of both information sources (D). The imputation errors were calculated across different number of clusters (E) and different data-vs-sequence weights (F).](figureMS6.svg){#fig:missingness width="100%". tag="S6"}

To evaluate the robustness of our combinad dual data-motif clustering (DDMC) method in analyzing incomplete data sets, we designed a computational experiment wherein we removed specific observations and attempted to predict them using the cluster centers corresponding to the peptides those missing values belonged to (Figure 2A). The resulting mean squared errors between the actual and predicted values were compared to compared to commonly used imputation strategies such as the peptides' mean or minimum signal. Furthermore, we evaluated the imputation performance of our method when clustering the data by phosphorylation signal only, by sequence similarity only, or by combining both information sources (2B-D). These results indicate that MDCC clearly imputes missing values more accurately than the peptides' mean signal in all three cases. No noticeable differences were observed in the imputations performance using data or sequence only, or a mix of both. Next, we re-implemented this strategy to find out what number of clusters (2E) and weight (2F) yielded more accurate predictions. We found that a larger number of clusters and smaller weights (prioritizing phosphorylation signal over peptide sequence) minimized the imputation error. These data suggests that DDMC outperforms standard imputation strategies such as peptide mean signal (and minimum signal).

#TODO: 
- Compare to minimum signal
- Filling the missingness with 0's
- Matrix completion by PCA
- Add legend for each regression line in plots B-F and mix labels/titles