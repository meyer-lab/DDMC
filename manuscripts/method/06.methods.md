## Materials and Methods

All analysis was implemented in Python, and can be found at <https://github.com/meyer-lab/resistance-MS>.

### Preprocessing MS-based global signaling measurements

We generated 3 biological replicates of the signaling state of the AXL mutants cell lines which were first concatenated and log2-transformed. The phosphorylation signal of all peptides was then mean centered across cell lines. The MS-generated peptide sequences were modified to include +/-5 amino acids surrounding the phosphosite. Whenever needed, phosphosites were mapped into the proteome (retrieved from Uniprot’s release 2020_01) to extend the peptide’s sequence. Phosphosites located in the protein’s N- or C-terminus with less than 5 residues beyond the central phosphosite were discarded. Then, we filtered overlapping peptides out according to their variance. Peptides that appeared twice in the data set were discarded if their Pearson correlation was lower than 0.5 across all cell lines, and peptides that appeared more than three times were filtered out if their standard deviation was higher than 0.4 in any cell line. All overlapping peptides were then averaged. We applied a filter to discard any peptides that did not meet a fold-change threshold of 2 relative to PC9 WT.

### Expectation-maximization algorithm architecture

We constructed an EM algorithm that probabilistically and simultaneously models both the peptide phosphorylation levels with a GMM and the peptide sequences using either a PAM250 or binomial position enrichment model (see below). The hyperparameters of this algorithm are the number of clusters and the weight or scaling factor to prioritize either the data or the sequence scores. during the Expectation- or E-step, the algorithm guesses a probability distribution given the current model parameters to assign every peptide into a cluster based on its maximum likelihood estimation, and in the Maximization- or M-step, the algorithm re-estimates the model parameters using the cluster assignments calculated during the previous step. For each cluster during the E-step, the final score is the sum of the GMM and the sequence scores, multiplied by a user-defined weight which scales both scores. A weight of 0 or a very large number only scores the data or sequence, respectively. Then model parameters are updated during the M-step based on the assignments generated during the previous E-step. These two steps repeat until convergence.

### Clustering phosphorylation levels using a Gaussian Mixture Model (GMM)

The GMM models the vector of phosphorylation measurements for every peptide across cell lines as being sampled from a multivariate Gaussian distribution–which is a generalization of a standard Gaussian distribution to multiple correlated variables–in which each component has its own covariance matrix. Thus, upon initialization with random cluster assignments, during the E-step the GMM generates the probabilities–or scores–of each peptide being assigned to every cluster according to the phosphorylation signal. After all peptide assignments are made, the parameters of the individual Gaussian distribution components–namely the mixture component weights and component mean, as well as the diagonal covariance matrix–are updated in the M-step. These two steps repeat until convergence.

### Clustering peptide sequences through a binomial model or a PAM250 matrix

To calculate the distance between a query peptide and each cluster to generate a sequence score, we developed two strategies either by implementing a PAM250 transition matrix or using a binomially distributed model. Upon model initialization with random cluster assignments, the binomial method will use the cluster sequences to first generate counts matrices which will be then compared to a background set of 371,203 random MS-generated p-sites (retrieved from PhosphoSitePlus) to find statistically significant residue/position pairs. Statistical significance is calculated using a binomially distributed model (see equation 1 below) so that for every cluster versus background comparison, the resulting binomial matrix will display a p-value for every residue/position pair.

Binomial formula?                                                                                                   (1) 

Hence, during the E-step a binomial matrix is generated for each cluster and the corresponding score for a query peptide is the mean of the log(p-values) extracted from the corresponding binomial probability matrix. In the PAM250 method, the sequence scores are the mean pairwise sequence distances between the current query sequence and the cluster sequences. 

### Exhaustive hyperparameter search

We constructed an integrated modeling pipeline by chaining the co-clustering method to a PLSR model. We assessed the model predictive ability by performing leave-one-out-cross-validation (LOOCV) across the entire model pipeline. That is, for every LOOCV iteration, one cell line is left out before both the clustering and regression analysis. Using this strategy, we conducted an exhaustive search of hyperparameter combinations–number of clusters, data versus sequence weight, and number of components–to find the set that yields the best predictive performance.
